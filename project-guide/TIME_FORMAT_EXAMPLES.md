# 时间显示格式说明

## 📊 存储单位

所有工具使用时间在配置文件中以 **秒（seconds）** 为单位存储。

```json
{
  "name": "Cytoscape",
  "total_runtime": 9000,  // 单位：秒
  "last_used": "2025-01-20T14:30:00"
}
```

---

## 🎨 显示格式规则

根据使用时长自动选择最合适的显示单位：

### 规则 1: 小于 1 分钟 → 显示秒

| 秒数 | 显示格式 |
|------|---------|
| 0秒  | "0秒" |
| 15秒 | "15秒" |
| 30秒 | "30秒" |
| 45秒 | "45秒" |
| 59秒 | "59秒" |

**适用场景**：快速测试工具

---

### 规则 2: 1-120 分钟 → 显示分钟

| 秒数 | 分钟数 | 显示格式 |
|------|--------|---------|
| 60秒  | 1分钟  | "1分钟" |
| 90秒  | 1.5分钟 | "1分钟" |
| 300秒 | 5分钟  | "5分钟" |
| 900秒 | 15分钟 | "15分钟" |
| 1800秒 | 30分钟 | "30分钟" |
| 3600秒 | 60分钟 | "60分钟" |
| 5400秒 | 90分钟 | "90分钟" |
| 7199秒 | 119.98分钟 | "119分钟" |

**适用场景**：日常使用

---

### 规则 3: 120+ 分钟 → 显示小时

| 秒数 | 小时数 | 显示格式 |
|------|--------|---------|
| 7200秒  | 2.0小时  | "2.0小时" |
| 9000秒  | 2.5小时  | "2.5小时" |
| 10800秒 | 3.0小时  | "3.0小时" |
| 18000秒 | 5.0小时  | "5.0小时" |
| 36000秒 | 10.0小时 | "10.0小时" |

**适用场景**：长时间使用

---

## 💡 为什么这样设计？

### 1. **避免精度过剩**

❌ **不好的设计**：
- 使用 30 秒 → 显示 "0.008小时"（难以理解）
- 使用 90 分钟 → 显示 "1小时30分钟0秒"（过于详细）

✅ **我们的设计**：
- 使用 30 秒 → 显示 "30秒"（直观）
- 使用 90 分钟 → 显示 "90分钟"（简洁）

### 2. **符合用户直觉**

- **短时间使用** → 用户关心秒数
- **中等时间使用** → 用户关心分钟数
- **长时间使用** → 用户关心小时数

### 3. **120分钟临界点的选择**

为什么选择 120 分钟（2小时）作为分界点？

- **小于 2 小时**：分钟数更直观（"90分钟" vs "1.5小时"）
- **大于 2 小时**：小时数更简洁（"3.5小时" vs "210分钟"）
- **参考Steam**：游戏平台也使用类似的策略

---

## 📝 实际示例

### 示例 1: FastQC 质量检测

```python
# 用户使用 FastQC 分析了一个小型测序文件
total_runtime = 45  # 秒

# 显示
"使用时间: 45秒"
```

### 示例 2: Cytoscape 网络分析

```python
# 用户使用 Cytoscape 构建和分析了生物网络
total_runtime = 3600  # 秒（60分钟）

# 显示
"使用时间: 60分钟"
```

### 示例 3: IGV 基因组浏览

```python
# 用户使用 IGV 长时间浏览基因组数据
total_runtime = 9000  # 秒（2.5小时）

# 显示
"使用时间: 2.5小时"
```

### 示例 4: 累计使用

```python
# 用户多次使用工具，累计时间
# 第1次: 300秒（5分钟）
# 第2次: 600秒（10分钟）
# 第3次: 3600秒（60分钟）
total_runtime = 4500  # 秒（75分钟）

# 显示
"使用时间: 75分钟"
```

---

## 🌍 多语言支持

### 中文 (zh_CN)

| 秒数 | 显示 |
|------|------|
| 45秒 | "45秒" |
| 900秒 | "15分钟" |
| 9000秒 | "2.5小时" |

### 英文 (en_US)

| 秒数 | 显示 |
|------|------|
| 45秒 | "45s" |
| 900秒 | "15min" |
| 9000秒 | "2.5h" |

### 日文 (ja_JP)

| 秒数 | 显示 |
|------|------|
| 45秒 | "45秒" |
| 900秒 | "15分" |
| 9000秒 | "2.5時間" |

---

## 🔧 代码实现

### 使用时间格式化函数

```python
from utils.time_formatter import format_runtime

# 获取工具使用时间（秒）
total_runtime = tool_data.get('total_runtime', 0)

# 格式化显示
formatted_time = format_runtime(total_runtime, language='zh_CN')

# 示例输出：
# 45 秒 → "45秒"
# 900 秒 → "15分钟"
# 9000 秒 → "2.5小时"
```

### 三种格式化选项

#### 1. `format_runtime()` - 智能格式化（推荐）

```python
format_runtime(45)    # "45秒"
format_runtime(900)   # "15分钟"
format_runtime(9000)  # "2.5小时"
```

#### 2. `format_runtime_detailed()` - 详细格式化

```python
format_runtime_detailed(45)    # "45秒"
format_runtime_detailed(90)    # "1分钟30秒"
format_runtime_detailed(3665)  # "1小时1分钟"
```

#### 3. `format_runtime_compact()` - 紧凑格式化

```python
format_runtime_compact(45)     # "0:00:45"
format_runtime_compact(3665)   # "1:01:05"
format_runtime_compact(36000)  # "10:00:00"
```

---

## ⚙️ 配置选项

### 当前默认设置

```python
# 时间临界点
SECONDS_THRESHOLD = 60      # 1分钟
MINUTES_THRESHOLD = 7200    # 120分钟

# 显示精度
HOUR_DECIMAL_PLACES = 1     # 小时显示1位小数
```

### 未来可配置项

如果需要，可以在设置中添加：

```python
{
  "time_display": {
    "mode": "smart",           // smart, detailed, compact
    "hour_threshold": 120,      // 多少分钟后切换到小时
    "show_seconds": true,       // 是否显示秒
    "decimal_places": 1         // 小时的小数位数
  }
}
```

---

## 📊 对比其他软件

### Steam（游戏平台）

- < 1小时: 显示分钟
- > 1小时: 显示小时（整数）

### Discord（通话时间）

- < 1分钟: 显示秒
- < 60分钟: 显示分钟
- > 60分钟: 显示小时和分钟

### BioNexus（我们的方案）

- < 1分钟: 显示秒
- 1-120分钟: 显示分钟
- > 120分钟: 显示小时（1位小数）

**优势**：更适合生物信息学工具的使用场景，平衡了精度和可读性。

---

## ✅ 总结

| 使用时长范围 | 显示单位 | 示例 | 适用场景 |
|-------------|---------|------|---------|
| 0-59秒 | 秒 | "45秒" | 快速测试 |
| 1-119.98分钟 | 分钟 | "15分钟" | 日常使用 |
| 120分钟+ | 小时 | "2.5小时" | 长时间使用 |

**核心理念**：根据使用时长自动选择最合适的显示单位，让用户一眼就能理解工具的使用情况。
